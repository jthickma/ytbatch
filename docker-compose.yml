services:
  ytbatch:
    build: .
    container_name: ytbatch_ephemeral
    # 'unless-stopped' will restart the container if it crashes, 
    # preserving data until the container is explicitly removed.
    restart: unless-stopped
    ports:
      - "8899:8899"
    environment:
      - SECRET_KEY=change_me_to_a_secure_key 
      - PORT=8899
      - MAX_WORKERS=4
      - TEMP_DIR=/app/temp_data
    # Optional healthcheck
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8899/api/status"]
      interval: 30s
      timeout: 10s
      retries: 3