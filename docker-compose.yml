services:
  ytbatch-web:
    build:
      context: ./web
    restart: unless-stopped
    expose:
      - "5000"
    volumes:
      - ./data/input:/input
      - ./data/downloads:/downloads
      - ./data/queue:/queue
    environment:
      - FLASK_ENV=production
      - PYTHONUNBUFFERED=1
    networks:
      - easypanel-ttdl
      - ytbatch-network

  ytbatch-worker:
    build:
      context: ./worker
    restart: unless-stopped
    volumes:
      - ./data/input:/input
      - ./data/downloads:/downloads
      - ./data/queue:/queue
    environment:
      - YTBATCH_POLL_INTERVAL=2
      - MAX_CONCURRENT_DOWNLOADS=3
      - PYTHONUNBUFFERED=1
    networks:
      - easypanel-ttdl
      - ytbatch-network

networks:
  ytbatch-network:
    driver: bridge
  easypanel-ttdl:
    external: true
